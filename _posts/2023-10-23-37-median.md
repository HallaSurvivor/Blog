---
layout: post
title: A truly incredible fact about the number 37
tags:
  - 
---

So I was on math stackexchange the other day, and I saw [a cute post][1] 
looking for a book which lists, for many many integers, facts that Ramanujan 
could have told Hardy if he'd take a cab other than [1729][2]. A few days ago 
OP answered their own question, saying that the book in question was 
[_Those Fascinating Numbers_][3] by Jean-Marie De Koninck. I decided to take 
a glance through it to see what kinds of facts lie inside 
(and also to see _just_ how many integers are covered!). Not only was I 
overwhelmed by the number of integers and the number of facts about them, 
the _preface_ already includes one of the single wildest facts I've ever heard, 
and I have to talk about it here! Here's a direct quote from the preface:

> 37, the median value for the second prime factor of an integer; 
> thus the probability that the second prime factor of an integer 
> chosen at random is smaller than 37 is approximately $\frac{1}{2}$;

My jaw was on the floor when I read this, haha. First it sounded totally 
unbelievable, since 37 is a tiny number in the grand scheme of things. Then 
it started to sound slightly more plausible... After all, about half of all 
integers have $2$ as their smallest prime factor. It makes sense that smaller 
primes should be more frequent among the smallest factors of numbers! But then 
I thought "how can you possibly _prove_ this!?". I'm not much of an analytic 
number theorist[^1], but I know that they have good estimates on a lot of 
facts like this. I decided it would be fun to try and find and understand a 
proof of this fact, and also write some [sage][4] code to test it!

So then let's go ahead and do it ^_^

---

First, I think, the sage code. I want to know if this really works!

"Obvoiusly" there's no uniform distribution on the natural numbers, so 
what does it even mean to choose a "random" one? The way the number theorists 
usually solve this problem is by fixing a large number $N$ and looking at 
the probabilities when you pick a random number between $1$ and $N$. Then you 
look at the $N \to \infty$ limit of these probabilities.

So for us, we'll want to first fix a large number $N$ and then work with 
numbers $\leq N$. For $N$ kind of small, we can just find the second prime 
factor of ecah number $\leq N$ and _check_ the median!

<div class="auto">
<script type="text/x-sage">

def getSecondSmallestFactors(N):
    data = []
    for n in range(1, N):
        if n % 100000 == 0:
            print("{n} / {N}".format(n=n, N=N))

        fs = factor(n)
        if len(fs) > 1:
            second_smallest = fs[1][0]
            data += [second_smallest]
    
    return data

@interact
def _(N=input_box(10^6, width=10, label="$N$")):
    data = getSecondSmallestFactors(N)
    show("median second prime: ", numpy.median(data))

</script>
</div>


---

<div class="auto">
<script type="text/x-sage">
u, z = var('u, z')
PhiStar(z) = integrate(exp(-u^2 / 2) / (sqrt(2*pi)), u, z, oo)
PhiNaught(z) = (1/3 + 0.2615 - z^2 / 3) * exp(-z^2 / 2)

estimate(z) = PhiStar(z) - PhiNaught(z) / sqrt(4*pi)

plot(estimate, z, -2, 2) + plot(lambda z: 0.5, z, -2, 2, color="orange")

</script>
</div>

So our solution for $z$ is somewhere between $-\frac{1}{2}$ and $0$. Let's ask sage 
to find it explicitly!

<div class="auto">
<script type="text/x-sage">
u, z = var('u, z')
PhiStar(z) = integrate(exp(-u^2 / 2) / (sqrt(2*pi)), u, z, oo)
PhiNaught(z) = (1/3 + 0.2615 - z^2 / 3) * exp(-z^2 / 2)

estimate(z) = PhiStar(z) - PhiNaught(z) / sqrt(4*pi)

show("z = ", (estimate(z) == 1/2).find_root(-.5,0))
</script>
</div>

So $n = \exp \exp (2 + \sqrt{2} z) \approx


---

[^1]: Absolutely the understatement of the year

[1]: https://math.stackexchange.com/questions/4767549/the-book-youll-need-when-someone-came-up-with-a-random-car-plate-number/4790221#4790221
[2]: https://en.wikipedia.org/wiki/1729_(number)
[3]: https://bookstore.ams.org/mbk-64
[4]: https://sagemath.org
