---
layout: post
title: Solving More Problems with Quantifier Elimination and Sage
tags:
  - sage
---

TOOD: describe the question: 

https://math.stackexchange.com/questions/4676094/is-it-possible-to-reformulate-this-optimization-problem-as-a-geometric-program/4676127#4676127

Then go through the sage code for solving the problem.

<div class="linked">
<script type="text/x-sage">
"""
We're trying our best to minimize P on x,y,z in [1,4]
subject to x >= y,z
"""

qf = qepcad_formula
x,y,z = var('x,y,z')

P = x / (2*x + 3*y) + y / (y+z) + z / (x+z)
Q = x * (y+z) * (z+x) + y * (2*x + 3*y) * (z+x) + z * (2*x + 3*y) * (y+z) >= 34/33 * (2*x + 3*y) * (y+z) * (x+z)

# choose 100000 random points x,y,z
N = 100000

print("generating points")
pts = []
for blah in range(N):
    z = uniform(1,4)
    y = uniform(1,4)
    x = uniform(max(y,z),4)
    pts += [(x,y,z)]

# get the best choice of (x,y,z)
# oh how I miss functional programming :(
print("computing max/min")
lowest = pts[0]
highest = pts[0]
for (x,y,z) in pts:
    if P.subs(x=x,y=y,z=z) <= P.subs(x=lowest[0], y=lowest[1], z=lowest[2]):
        lowest = (x,y,z)

    if P.subs(x=x,y=y,z=z) >= P.subs(x=highest[0], y=highest[1], z=highest[2]):
        highest = (x,y,z)

l = P.subs(x=lowest[0],y=lowest[1],z=lowest[2])
h = P.subs(x=highest[0],y=highest[1],z=highest[2])

print("max: ", h, "at", highest)
print("min: ", l, "at", lowest)

def normalize(r):
    return (r-l)/(h - l)

print("plotting points")
sum([point3d((x,y,z), color=colors.blue.blend(colors.red, fraction=normalize(P.subs(x=x,y=y,z=z)))) for (x,y,z) in pts])


</script>
</div>
